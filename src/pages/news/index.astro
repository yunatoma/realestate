---
import client from '../../lib/microcms/client';
import type { MicroCMSListResponse } from 'microcms-js-sdk';

const formatDate = (dateStr: string) => {
  const date = new Date(dateStr);
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}.${month}.${day}`;
};

export type News = {
  id: string;
  createdAt: string;
  updatedAt: string;
  publishedAt: string;
  revisedAt: string;
  title: string;
  content: string;
  category: {
    id: string;
    name: string;
  };
};

// お知らせカテゴリーで絞り込み、全件取得
const newsList = await client.get<MicroCMSListResponse<News>>({
  endpoint: 'news',
  queries: {
    filters: 'category[equals]dic21ntqug7',
  },
});
---

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>お知らせ一覧</title>
</head>

<h1>お知らせ一覧</h1>
<ul class="list-container">
  {newsList.contents.map((item) => (
    <li>
      <a href={`/news/${item.id}`}>{item.title}</a>
      <span class="date">{formatDate(item.updatedAt)}</span>
    </li>
  ))}
</ul>

<style>
/* 任意のスタイル */
</style>